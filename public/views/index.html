<!DOCTYPE html>
<html lang="ja">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="../stylesheets/style.css" />

    <title>Todoã‚¢ãƒ—ãƒª</title>
  </head>

  <body>
    <!--
    <h1>Todo App</h1>
    -->

    <nav>
      <a href="#" data-toggle="modal" data-target="#createtaskModal"
        >Add task</a
      >
      <a href="#" id="alldelete-button">Delete all</a>
      <a href="#" id="allchecks-button">Select all</a>
      <a href="#" id="allunchecks-button">Deselect all</a>
      <a href="#" data-toggle="modal" data-target="#createcategoryModal"
        >category</a
      >
      <div class="animation start-home"></div>
    </nav>

    <!--+ãƒœã‚¿ãƒ³ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼
    <a href="#"
      ><button
        type="button"
        class="btn btn-dark"
        style="margin-top: 10px; margin-bottom: 10px"
        data-toggle="modal"
        data-target="#createtaskModal"
      >
        +
      </button></a
    >
    ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼+ãƒœã‚¿ãƒ³çµ‚äº†--

    ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼--ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒœã‚¿ãƒ³ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼
    <td>
      <input id="menu1" type="checkbox" />
      <label for="menu1" class="back"></label>
      <nav class="menu">
        <ul>
          <li>
            <a href="#">
              <span>ãƒœã‚¿ãƒ³ï¼‘ </span>
            </a>
          </li>
          <li>
            <a href="#">
              <span>ãƒœã‚¿ãƒ³ï¼’ </span>
            </a>
          </li>
        </ul>
        <label for="menu1">é–‰ã˜ã‚‹</label>
      </nav>
      <section>
        <label for="menu1" class="menu_btn"></label>
      </section>
    </td>
    ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒœã‚¿ãƒ³çµ‚äº†--

    ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ä¸€æ‹¬å‰Šé™¤ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼
    <a href="#">
      <span>
        <button
          class="btn btn-danger"
          style="margin-top: 10px; margin-bottom: 10px"
          id="alldelete-button"
        >
          ä¸€æ‹¬å‰Šé™¤
        </button>
      </span>
    </a>
    ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ä¸€æ‹¬å‰Šé™¤çµ‚äº†--ãƒ¼ãƒ¼

    ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ä¸€æ‹¬é¸æŠãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼
    <a href="#">
      <span>
        <button
          class="btn btn-dark"
          style="margin-top: 10px; margin-bottom: 10px"
          id="allchecks-button"
        >
          å…¨ã¦é¸æŠ
        </button>
      </span>
    </a>
    ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ä¸€æ‹¬å–é¸æŠçµ‚äº†ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼

    ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ç·¨é›†ãƒœã‚¿ãƒ³ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼
    <a href="#"
      ><button
        type="button"
        class="btn btn-dark"
        style="margin-top: 10px; margin-bottom: 10px"
        data-toggle="modal"
        data-target="#updatecategoryModal"
      >
        ç·¨é›†
      </button></a
    >
     ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ç·¨é›†ãƒœã‚¿ãƒ³-->

    <!--todoåã€æœŸé™ã€ã‚¢ãƒ©ãƒ¼ãƒˆã®ãƒ†ãƒ¼ãƒ–ãƒ«-->
    <ul id="task-list"></ul>
    <!--todoåã€æœŸé™ã€ã‚¢ãƒ©ãƒ¼ãƒˆã®ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆçµ‚äº†ï¼‰-->

    <!--ãƒšãƒ¼ã‚¸ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹-->
    <a href="" class="btn btn--circle btn--circle-c btn--shadow"
      ><i class="fas fa-arrow-up">ğŸ”</i></a
    >
    <!--ãƒšãƒ¼ã‚¸ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹ï¼ˆçµ‚äº†ï¼‰-->

    <!-- ã‚¿ã‚¹ã‚¯ã®è¿½åŠ (+)ã‚’æŠ¼ã—ãŸå ´åˆ -->
    <div
      class="modal fade"
      id="createtaskModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="createtaskLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document" id="create-form">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="createtaskModalLabel">ã‚¿ã‚¹ã‚¯ç™»éŒ²</h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <form>
                <label for="task">ã‚¿ã‚¹ã‚¯</label>
                <input type="text" class="form-control" name="task" />
                <label
                  for="deadline"
                  style="margin-top: 10px; margin-bottom: 10px"
                  >æœŸé™</label
                >
                <input type="date" name="deadline" class="form-control" />
                <label style="margin-top: 10px; margin-bottom: 10px"
                  >ã‚«ãƒ†ã‚´ãƒª</label
                >
                <select class="form-control" id="category" name="category">
                  <option value="1">å‹‰å¼·</option>
                  <option value="2">ä»•äº‹</option>
                  <option value="3">å®¶äº‹</option>
                  <option value="4">ç”Ÿæ´»</option>
                </select>
              </form>
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-dismiss="modal"
            >
              ã‚­ãƒ£ãƒ³ã‚»ãƒ«
            </button>
            <button type="button" class="btn btn-primary" id="create-task">
              ç™»éŒ²
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- ã‚¿ã‚¹ã‚¯ã®è¿½åŠ ã‚’æŠ¼ã—ãŸå ´åˆ(çµ‚äº†) -->

    <!-- ã‚«ãƒ†ã‚´ãƒªã®è¿½åŠ ã‚’æŠ¼ã—ãŸå ´åˆ -->
    <div
      class="modal fade"
      id="createcategoryModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="createcategoryLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document" id="create-form">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="createtaskModalLabel">ã‚«ãƒ†ã‚´ãƒªè¿½åŠ </h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <form>
                <label for="task">ã‚«ãƒ†ã‚´ãƒªå</label>
                <input type="text" class="form-control" name="task" />
                <label style="margin-top: 10px; margin-bottom: 10px"
                  >æ—¢å­˜ã®ã‚«ãƒ†ã‚´ãƒª</label
                >
                <select class="form-control" id="category" name="category">
                  <option value="1">å‹‰å¼·</option>
                  <option value="2">ä»•äº‹</option>
                  <option value="3">å®¶äº‹</option>
                  <option value="4">ç”Ÿæ´»</option>
                  <ul id="category-list"></ul>
                </select>
              </form>
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-dismiss="modal"
            >
              ã‚­ãƒ£ãƒ³ã‚»ãƒ«
            </button>
            <button type="button" class="btn btn-primary" id="create-category">
              ç™»éŒ²
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- ã‚«ãƒ†ã‚´ãƒªã®è¿½åŠ ã‚’æŠ¼ã—ãŸå ´åˆ(çµ‚äº†) -->

    <!--ç·¨é›†ã‚’æŠ¼ã—ãŸå ´åˆ ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼
    <div
      class="modal fade"
      id="updatecategoryModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="updatecategoryModal"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document" id="create-form">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="createtaskModalLabel">ã‚«ãƒ†ã‚´ãƒªè¿½åŠ </h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <form>
                <label for="task">ã‚¿ã‚¹ã‚¯</label>
                <input type="text" class="form-control" name="task" />
                <label style="margin-top: 10px; margin-bottom: 10px"
                  >ã‚«ãƒ†ã‚´ãƒª</label
                >
                <select class="form-control" id="category" name="category">
                  <option value="1">å‹‰å¼·</option>
                  <option value="2">ä»•äº‹</option>
                  <option value="3">å®¶äº‹</option>
                  <option value="4">ç”Ÿæ´»</option>
                </select>
              </form>
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-dismiss="modal"
            >
              ã‚­ãƒ£ãƒ³ã‚»ãƒ«
            </button>
            <button type="button" class="btn btn-primary" id="create-task">
              ç™»éŒ²
            </button>
          </div>
        </div>
      </div>
    </div>
    ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ ç·¨é›†ã‚’æŠ¼ã—ãŸå ´åˆ(çµ‚äº†) -->

    <!-- æ›´æ–°ã‚’æŠ¼ã—ãŸå ´åˆ -->
    <div
      class="modal fade"
      id="update_taskModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="update_taskLabel"
      aria-hidden="true"
    >
      <div class="update-form" id="update-form" style="display: none">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="update_taskModalLabel">ã‚¿ã‚¹ã‚¯æ›´æ–°</h5>
              <button
                type="button"
                class="close"
                data-dismiss="modal"
                aria-label="Close"
              >
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <div class="form-group">
                <form>
                  <input type="hidden" name="id" />
                  <label for="task">ã‚¿ã‚¹ã‚¯</label>
                  <input
                    type="text"
                    class="form-control"
                    name="task"
                    id="task"
                  />
                  <label
                    for="Inputdate"
                    style="margin-top: 10px; margin-bottom: 10px"
                    >æœŸé™</label
                  >
                  <input
                    type="date"
                    name="deadline"
                    id="deadline"
                    class="form-control"
                  />
                  <label style="margin-top: 10px; margin-bottom: 10px"
                    >ã‚«ãƒ†ã‚´ãƒª</label
                  >
                  <select class="form-control" id="category" name="category">
                    <option value="1">å‹‰å¼·</option>
                    <option value="2">ä»•äº‹</option>
                    <option value="3">å®¶äº‹</option>
                    <option value="4">ç”Ÿæ´»</option>
                  </select>
                  <label
                    for="status"
                    style="margin-top: 10px; margin-bottom: 10px"
                    >ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</label
                  >
                  <select class="form-control" name="status" id="status">
                    <option value="1">é€²è¡Œä¸­</option>
                    <option value="2">å®Œäº†</option>
                  </select>
                </form>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-dismiss="modal"
              >
                ã‚­ãƒ£ãƒ³ã‚»ãƒ«
              </button>
              <button type="button" class="btn btn-primary" id="update-task">
                ç™»éŒ²
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- æ›´æ–°ã‚’æŠ¼ã—ãŸå ´åˆ(çµ‚äº†) -->

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script
      src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
      integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
      crossorigin="anonymous"
    ></script>

    <script src="../javascripts/index.js"></script>

    <script>
      //ã‚¿ã‚¹ã‚¯è¿½åŠ ã®ç™»éŒ²ãƒœã‚¿ãƒ³ã‚’æŠ¼ä¸‹æ™‚
      $("#create-task").on("click", async function () {
        const requestData = {
          taskName: $("#create-form input[name=task]").val(),
          deadline: $("#create-form input[name=deadline]").val(),
          category: $("#create-form select[name=category]").val(),
        };

        const responese = await httpPost(
          "//" + window.location.host + "/api/tasks",
          requestData
        );
        window.location.reload();
      });

      //ã‚¿ã‚¹ã‚¯ä¸€è¦§å–å¾—
      $(async function () {
        const response = await httpGet(
          "//" + window.location.host + "/api/tasks"
        );

        //ãƒªã‚¹ãƒˆã®ç¹°ã‚Šè¿”ã—è¡¨ç¤º(ã‚¢ãƒ­ãƒ¼é–¢æ•°)[menuãƒãƒ¼ã€ã‚¿ã‚¹ã‚¯åã€æœŸé™ã€ã‚¢ãƒ©ãƒ¼ãƒˆ]
        const list = response.map((item) => {
          //æœ¬æ—¥ã®å¹´ãƒ¼æœˆãƒ¼æ—¥ã‚’å¤‰æ›
          const today = new Date();
          const today_year = today.getFullYear(); //ä»Šæ—¥ã®å¹´
          const today_month = today.getMonth() + 1; //ä»Šæ—¥ã®æœˆ
          const today_day = today.getDate(); //ä»Šæ—¥ã®æ—¥

          //deadlineã®å¹´ãƒ¼æœˆãƒ¼æ—¥ã‚’å¤‰æ›
          const dead_year = Number(item.deadline.slice(0, 4)); //å¹´
          const dead_month = Number(item.deadline.slice(5, 7)); //æœˆ
          const dead_day = Number(item.deadline.slice(8, 10)); //æ—¥

          //ä»Šæ—¥ã¨ã€†åˆ‡ã®ãšã‚Œ
          const year_until = Number(`${dead_year - today_year}`); //ã€†åˆ‡ã¾ã§ã®å¹´
          const month_until = Number(`${dead_month - today_month}`); //ã€†åˆ‡ã¾ã§ã®æœˆ
          const day_until = Number(`${dead_day + 1 - today_day}`); //ã€†åˆ‡ã¾ã§ã®æ—¥æ•°

          var x = 30;

          //æ®‹ã‚Šæ—¥æ•°ã®è¨ˆç®—
          const until_deadline = `${
            365 * year_until + x * month_until + day_until
          }`;
          //è¡¨ç¤ºæ—¥ãŒ1æ—¥ãšã‚Œã‚‹ã®ã‚’ä¿®æ­£
          if (dead_day < 31) {
            dead_d = `${dead_day + 1}`;
          } else {
            dead_d = `${dead_day}`;
          }

          //æœŸé™ã¾ã§ã®æ—¥æ•°ã‚’è¨ˆç®—
          if (until_deadline > 0 && month_until == 0) {
            dead_until = "æœŸé™ã¾ã§æ®‹ã‚Š" + day_until + "æ—¥ã§ã™";
          } else if (until_deadline > 0 && month_until > 0) {
            dead_until =
              "æœŸé™ã¾ã§æ®‹ã‚Š" + month_until + "ãƒ¶æœˆã¨" + day_until + "æ—¥ã§ã™";
          } else {
            dead_until = "æœŸé™ã‚’éãã¦ã„ã¾ã™";
          }

          return `
            <table class="table table-striped" style="margin-top: 20px; margin-bottom: 10px">
              <tbody>
                <tr>
                  <td>
                    <input type="checkbox" class="checks" value="${item.id}"><br>
                  </td>
                  <th>
                      <div class="hidden_box">
                        <label for="label${item.id}"><div class="menu icon" ></div></label>
                        <input type="checkbox" id="label${item.id}"/>
                      <div class="hidden_show">
                       <!--éè¡¨ç¤ºã“ã“ã‹ã‚‰-->
                        <a href="#">
                                    <span>
                                      <button class="btn btn-danger" id="delete-button" data-id=${item.id} data-delete=${item.task_name}>å‰Šé™¤</button>
                                    </span>
                                  </a>

                                  <a href="#">
                                    <span>
                                      <button class="btn btn-primary" type="button" id="update-button" data-id=${item.id} data-toggle="modal" data-target="#update_taskModal">æ›´æ–°</button>
                                    </span>
                                  </a>
                        <!--ã“ã“ã¾ã§-->
                        </div>
                      </div>
                    </th>
                    <td> <div class="col" style="margin-top: 40px; margin-bottom: 10px"><span>${item.task_name}</span></div></td>
                     <td> <div class="col" style="margin-top: 40px; margin-bottom: 10px"><span>${dead_year}å¹´${dead_month}æœˆ${dead_d}æ—¥</span></div></td>
                    <td>
                      <div class="hidden_box_1">
                        <input type="checkbox" class="toggle" id="label" style="margin-top: 10px; margin-bottom: 10px"/>
                      <div class="hidden_show">
                       <!--éè¡¨ç¤ºã“ã“ã‹ã‚‰-->
                       <div class="col text-danger" style="margin-top: 10px; margin-bottom: 10px">${dead_until}</div>
                       <!--ã“ã“ã¾ã§-->
                      </div>
                      </div>
                    </td>


                    </tr>
              </tbody>
            </table>`;
        });
        $("ul#task-list").append(list);
      });

      //æ›´æ–°ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚
      $(document).on("click", "#update-button", async function () {
        $("#update-form").show();
        const id = $(this).data("id");
        const response = await httpGet(
          "//" + window.location.host + `/api/tasks/${id}`
        );
        //æ—¥ä»˜ã®å¤‰æ›´
        const date = new Date(response[0].deadline);
        const year = date.getFullYear();
        const month = ("0" + (date.getMonth() + 1)).slice(-2);
        const day = ("0" + date.getDate()).slice(-2);
        const deadlineVal = `${year}-${month}-${day}`;

        $("#update-form input[name=id]").val(response[0].id);
        $("#update-form input[name=task]").val(response[0].task_name);
        $("#update-form input[name=deadline]").val(deadlineVal);
        $("#update-form input[name=category]").val(response[0].category_id);
        $("#update-form input[name=status]").val(response[0].task_status);
      });

      //ä¿å­˜ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚
      $("#update-task").on("click", async function () {
        const id = $("#update-form input[name=id]").val();

        const requestData = {
          taskName: $("#update-form input[name=task]").val(),
          deadline: $("#update-form input[name=deadline]").val(),
          category: $("#update-form select[name=category]").val(),
          status: $("#update-form select[name=status]").val(),
        };

        const response = await httpUpdate(
          "//" + window.location.host + `/api/tasks/${id}`,
          requestData
        );

        window.location.reload();
      });

      //å‰Šé™¤ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚
      $(document).on("click", "#delete-button", async function () {
        const taskName = $(this).data("delete");
        if (confirm(`ä¸‹è¨˜ã®å†…å®¹ã‚’å‰Šé™¤ã—ã¾ã™ã€‚\n ${taskName}`)) {
          const id = $(this).data("id");

          const response = await httpDelete(
            "//" + window.location.host + `/api/tasks/${id}`
          );

          window.location.reload();
        }
      });

      //å…¨ã¦é¸æŠ
      $("#allchecks-button").on("click", async function () {
        var allchecks = document.getElementsByClassName("checks");

        for (i = 0; i < allchecks.length; i++) {
          allchecks[i].checked = true;
        }
      });

      //å…¨ã¦é¸æŠè§£é™¤
      $("#allunchecks-button").on("click", async function () {
        var allunchecks = document.getElementsByClassName("checks");

        for (i = 0; i < allunchecks.length; i++) {
          allunchecks[i].checked = false;
        }
      });

      //ä¸€æ‹¬å‰Šé™¤ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚
      $("#alldelete-button").on("click", async function () {
        var checks = document.getElementsByClassName("checks");
        var str = "";

        for (i = 0; i < checks.length; i++) {
          if (checks[i].checked === true) {
            str = checks[i].value + " ";

            const response = await httpDelete(
              "//" + window.location.host + `/api/tasks/${str}`
            );
          }
        }
        window.location.reload();
      });

      //ã‚«ãƒ†ã‚´ãƒªè¿½åŠ ã®ç™»éŒ²ãƒœã‚¿ãƒ³ã‚’æŠ¼ä¸‹æ™‚
      $("#create-category").on("click", async function () {
        const requestData = {
          categoryName: $("#create-form input[name=task]").val(),
        };

        const responese = await httpPost(
          "//" + window.location.host + "/api/category",
          requestData
        );
        window.location.reload();
      });

      //ã‚«ãƒ†ã‚´ãƒªä¸€è¦§å–å¾—
      $(async function () {
        const response = await httpGet(
          "//" + window.location.host + "/api/category"
        );
      });
    </script>
  </body>
</html>
